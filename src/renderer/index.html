<!DOCTYPE html>
<!--
  index.html
  ==========
  Main UI for Trading 212 Portfolio Viewer

  This is a single-page application that displays:
  - Account summary (total value, cash, profit/loss)
  - Positions table (sorted by daily change)
  - Alerts and notifications

  STRUCTURE:
  - Header: App title and refresh button
  - Summary cards: Key metrics at a glance
  - Positions table: Sortable list of holdings
  - Alerts section: Recent alerts and warnings
-->
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Security: Prevent loading external resources -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'">

  <title>Trading 212 Portfolio Viewer</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

  <!-- =================================================================== -->
  <!-- HEADER -->
  <!-- =================================================================== -->
  <header class="app-header">
    <h1>Trading 212 Portfolio</h1>
    <div class="header-actions">
      <span id="last-update" class="last-update">Last update: --</span>
      <button id="refresh-btn" class="btn btn-primary">
        ↻ Refresh
      </button>
    </div>
  </header>


  <!-- =================================================================== -->
  <!-- MAIN CONTENT -->
  <!-- =================================================================== -->
  <main class="main-content">

    <!-- --------------------------------------------------------------- -->
    <!-- ERROR BANNER (hidden by default) -->
    <!-- --------------------------------------------------------------- -->
    <div id="error-banner" class="error-banner hidden">
      <span id="error-message"></span>
      <button id="error-dismiss" class="btn-small">✕</button>
    </div>


    <!-- --------------------------------------------------------------- -->
    <!-- ACCOUNT SUMMARY CARDS -->
    <!-- --------------------------------------------------------------- -->
    <section class="summary-section">
      <h2>Account Summary</h2>

      <div class="summary-cards">
        <!-- Total Portfolio Value -->
        <div class="card">
          <div class="card-label">Total Value</div>
          <div id="total-value" class="card-value">--</div>
        </div>

        <!-- Cash Available -->
        <div class="card">
          <div class="card-label">Cash Available</div>
          <div id="cash-available" class="card-value">--</div>
        </div>

        <!-- Total Invested -->
        <div class="card">
          <div class="card-label">Invested</div>
          <div id="total-invested" class="card-value">--</div>
        </div>

        <!-- Overall Profit/Loss -->
        <div class="card">
          <div class="card-label">Overall P/L</div>
          <div id="total-pnl" class="card-value">--</div>
          <div id="total-pnl-percent" class="card-subvalue">--</div>
        </div>
      </div>
    </section>


    <!-- --------------------------------------------------------------- -->
    <!-- POSITIONS TABLE -->
    <!-- --------------------------------------------------------------- -->
    <section class="positions-section">
      <h2>Positions <span id="position-count" class="count-badge">0</span></h2>

      <div class="table-controls">
        <label for="sort-select">Sort by:</label>
        <select id="sort-select">
          <option value="dailyChangePercent-asc">Daily Change % (Losers first)</option>
          <option value="dailyChangePercent-desc">Daily Change % (Gainers first)</option>
          <option value="ppl-asc">Total P/L (Losers first)</option>
          <option value="ppl-desc">Total P/L (Gainers first)</option>
          <option value="currentValue-desc">Value (Highest first)</option>
          <option value="shortTicker-asc">Ticker (A-Z)</option>
        </select>
      </div>

      <div class="table-container">
        <table id="positions-table" class="positions-table">
          <thead>
            <tr>
              <th>Ticker</th>
              <th>Quantity</th>
              <th class="number">Avg Price</th>
              <th class="number">Current Price</th>
              <th class="number">Current Value</th>
              <th class="number">Daily Change</th>
              <th class="number">Total P/L</th>
            </tr>
          </thead>
          <tbody id="positions-body">
            <!-- Positions will be inserted here by JavaScript -->
            <tr class="loading-row">
              <td colspan="7">Loading positions...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>


    <!-- --------------------------------------------------------------- -->
    <!-- ALERTS SECTION -->
    <!-- --------------------------------------------------------------- -->
    <section class="alerts-section">
      <h2>Alerts <span id="alert-count" class="count-badge">0</span></h2>

      <div id="alerts-container" class="alerts-container">
        <p class="no-alerts">No alerts triggered today.</p>
      </div>

      <!-- Downtrend Warnings -->
      <div id="downtrends-container" class="downtrends-container hidden">
        <h3>⚠️ Multi-Day Downtrends</h3>
        <ul id="downtrends-list"></ul>
      </div>
    </section>

  </main>


  <!-- =================================================================== -->
  <!-- FOOTER -->
  <!-- =================================================================== -->
  <footer class="app-footer">
    <p>Trading 212 Portfolio Viewer • Read-Only • Data refreshes automatically</p>
  </footer>


  <!-- JavaScript (loaded after DOM) -->
  <script src="renderer.js"></script>

</body>
</html>
